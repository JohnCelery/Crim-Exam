<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accessible Quiz</title>
  <style>
:root {
  --bg: #0b0c10;
  --card: #12141a;
  --text: #f5f7fb;
  --accent: #20c997;
  --muted: #9aa3b5;
  --error: #ff6b6b;
  --border: #1f2230;
  --focus: #f1c40f;
  font-size: 16px;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at 20% 20%, rgba(32, 201, 151, 0.05), transparent 30%),
    radial-gradient(circle at 80% 0%, rgba(241, 196, 15, 0.08), transparent 25%),
    var(--bg);
  color: var(--text);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.page-header,
.page-footer {
  padding: 1.5rem clamp(1rem, 4vw, 3rem);
  background: var(--card);
  border-bottom: 1px solid var(--border);
}

.page-footer {
  border-top: 1px solid var(--border);
  border-bottom: none;
  margin-top: auto;
  text-align: center;
  color: var(--muted);
}

.page-header .branding h1 {
  margin: 0;
}

.page-header .branding .tagline {
  margin: 0.35rem 0 0;
  color: var(--muted);
}

.progress {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(10rem, 1fr));
  gap: 0.5rem;
  margin-top: 1rem;
  color: var(--muted);
}

main {
  padding: clamp(1rem, 4vw, 3rem);
  display: grid;
  gap: 1.5rem;
}

.quiz,
.review {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 1rem;
  padding: clamp(1rem, 3vw, 2rem);
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.35);
}

.quiz-form {
  display: grid;
  gap: 1rem;
}

.question {
  display: grid;
  gap: 0.75rem;
}

.question h2 {
  margin: 0;
  font-size: 1.2rem;
}

.choices {
  display: grid;
  gap: 0.5rem;
}

.choice {
  border: 1px solid var(--border);
  border-radius: 0.75rem;
  padding: 0.75rem 1rem;
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 0.75rem;
  align-items: center;
  background: #161925;
  transition: border-color 0.2s ease, transform 0.15s ease, box-shadow 0.2s ease;
  position: relative;
  overflow: hidden;
}

.choice:hover {
  border-color: var(--accent);
  transform: translateY(-1px);
  box-shadow: 0 10px 26px rgba(32, 201, 151, 0.14);
}

.choice input[type="radio"] {
  accent-color: var(--accent);
  width: 1.1rem;
  height: 1.1rem;
  border: 2px solid #1f2636;
  border-radius: 999px;
}

.choice::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, rgba(32, 201, 151, 0.18), transparent 55%);
  opacity: 0;
  transform: scale(0.85);
  transition: opacity 0.2s ease, transform 0.25s ease;
  pointer-events: none;
  mix-blend-mode: screen;
}

.choice:hover::after {
  opacity: 0.5;
  transform: scale(1.05);
}

.choice:focus-within::after {
  opacity: 0.55;
}

.choice:has(input:checked) {
  border-color: var(--accent);
  box-shadow: 0 12px 32px rgba(32, 201, 151, 0.18), 0 0 0 2px rgba(32, 201, 151, 0.16);
  transform: translateY(-1px);
}

.choice:has(input:checked)::after {
  opacity: 0.65;
  transform: scale(1.15);
}

.choice:has(input:checked) input[type="radio"] {
  border-color: var(--accent);
  box-shadow: 0 0 0 4px rgba(32, 201, 151, 0.2);
}

.controls {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(9rem, 1fr));
  gap: 0.75rem;
}

button {
  position: relative;
  background: linear-gradient(135deg, #2fe6ae, #17b3c1);
  color: #0c0d13;
  border: 1px solid #1b1f2d;
  border-radius: 0.85rem;
  padding: 0.9rem 1.1rem 0.9rem 1.1rem;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 12px 30px rgba(23, 179, 193, 0.18);
  transition: filter 0.2s ease, transform 0.15s ease, box-shadow 0.2s ease;
  isolation: isolate;
}

button::before {
  content: "";
  margin-right: 0.35rem;
  display: none;
  align-items: center;
  justify-content: center;
}

#submit-btn::before {
  content: "‚úÖ";
  display: inline-flex;
}

#next-btn::before {
  content: "‚û°Ô∏è";
  display: inline-flex;
}

.reset-btn::before {
  content: "üîÑ";
  display: inline-flex;
}

button:hover {
  filter: brightness(1.05);
  transform: translateY(-1px);
  box-shadow: 0 16px 36px rgba(23, 179, 193, 0.28);
}

button:disabled {
  background: #2e3345;
  color: var(--muted);
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

button:active:not(:disabled) {
  transform: translateY(1px);
  box-shadow: 0 8px 18px rgba(23, 179, 193, 0.2);
}

.reset-btn {
  background: linear-gradient(135deg, #1b1f2d, #22283a);
  color: var(--text);
  border: 1px solid #292f43;
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.25);
}

.reset-btn:hover {
  border-color: var(--accent);
  background: linear-gradient(135deg, rgba(32, 201, 151, 0.14), rgba(23, 179, 193, 0.12));
}

.reset-btn:focus-visible {
  outline: 3px solid var(--focus);
  outline-offset: 4px;
  animation: ringPulse 1.2s ease-out infinite;
}

#submit-btn:focus-visible,
#next-btn:focus-visible {
  animation: ringPulse 1.2s ease-out infinite;
}

.feedback {
  min-height: 2rem;
  font-weight: 600;
}

.feedback .correct {
  color: var(--accent);
}

.feedback .incorrect {
  color: var(--error);
}

.section-header {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem 1rem;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.section-header h2 {
  margin: 0;
}

.review-list {
  display: grid;
  gap: 1rem;
}

.review-list:not(.is-visible) {
  display: none;
}

.review-card {
  border: 1px solid var(--border);
  border-radius: 0.75rem;
  padding: 0.75rem 1rem;
  background: #171b28;
}

.review-card h3 {
  margin: 0 0 0.35rem;
}

.review-card .status {
  font-weight: 700;
}

.review-card .status.correct {
  color: var(--accent);
}

.review-card .status.incorrect {
  color: var(--error);
}

.review-card .meta {
  color: var(--muted);
  margin: 0.35rem 0;
}

.review-card ul {
  margin: 0.35rem 0 0;
  padding-left: 1.25rem;
}

:focus {
  outline: 3px solid var(--focus);
  outline-offset: 3px;
}

@media (min-width: 900px) {
  main {
    grid-template-columns: 2fr 1fr;
  }

  .controls {
    position: sticky;
    bottom: 1.5rem;
    padding: 1rem;
    background: rgba(22, 25, 37, 0.9);
    border: 1px solid var(--border);
    border-radius: 1rem;
    backdrop-filter: blur(6px);
    box-shadow: 0 18px 48px rgba(0, 0, 0, 0.35);
    animation: floatIn 0.45s ease forwards;
    transform: translateY(12px);
    opacity: 0;
  }
}

@keyframes ringPulse {
  0% {
    box-shadow: 0 0 0 0 rgba(241, 196, 15, 0.5), 0 8px 20px rgba(0, 0, 0, 0.2);
  }
  60% {
    box-shadow: 0 0 0 8px rgba(241, 196, 15, 0), 0 12px 26px rgba(0, 0, 0, 0.25);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(241, 196, 15, 0), 0 8px 20px rgba(0, 0, 0, 0.2);
  }
}

@keyframes floatIn {
  0% {
    transform: translateY(12px);
    opacity: 0;
  }
  100% {
    transform: translateY(0);
    opacity: 1;
  }
}
  </style>
</head>
<body>
  <header class="page-header">
    <div class="branding">
      <h1>Criminology Quiz</h1>
      <p class="tagline">Test your knowledge with instant feedback.</p>
    </div>
    <div class="progress" aria-live="polite">
      <span id="progress-count">Question 1 of 1</span>
      <span id="score">Score: 0</span>
    </div>
  </header>

  <main>
    <section class="quiz" aria-label="Quiz section">
      <form id="quiz-form" class="quiz-form" aria-label="Quiz form">
        <div id="question-container"></div>
        <div class="controls">
          <button type="submit" id="submit-btn">Submit Answer</button>
          <button type="button" id="next-btn" disabled>Next Question</button>
          <button type="button" id="reset-btn" class="reset-btn">Restart quiz (clear progress)</button>
        </div>
      </form>
      <div id="feedback" class="feedback" aria-live="polite"></div>
    </section>

    <section class="review" aria-label="Review mode">
      <header class="section-header">
        <h2>Review Answers</h2>
        <p>Review your choices and explanations.</p>
        <button type="button" id="review-toggle">Toggle Review Mode</button>
      </header>
      <div id="review-list" class="review-list" aria-live="polite"></div>
    </section>
  </main>

  <footer class="page-footer">
    <p>Progress automatically saves to this browser.</p>
  </footer>

  <script>
const storageKeys = {
  index: 'quiz_current_index',
  score: 'quiz_score',
  answered: 'quiz_answered',
};

/**
 * Question model reference
 * @typedef {Object} QuizQuestion
 * @property {string} id
 * @property {string} prompt
 * @property {{ id: string, label: string }[]} choices
 * @property {string} correctChoiceId
 * @property {string} explanation
 */

/**
 * Placeholder loader for JSON-based question files.
 * Replace with fetch('/path/to/questions.json').then(res => res.json()).
 * @returns {Promise<QuizQuestion[]>}
 */
function loadQuestions() {
  const sampleQuestions = [
    {
      id: 'q1',
      prompt:
        'Under the omission rules in your outline, which situation most clearly creates a legal duty to act such that failure to act can be the actus reus of a crime?',
      choices: [
        { id: 'a', label: 'You see a stranger drowning at a public beach and decide not to help.' },
        {
          id: 'b',
          label:
            'You agree to care for your elderly neighbor and move her into your home, then ignore her medical needs and refuse to let others in to assist.',
        },
        { id: 'c', label: 'You walk past a car accident and call 911 but do not render aid.' },
        { id: 'd', label: 'You sell someone a defective ladder that later breaks and injures them.' },
      ],
      correctChoiceId: 'b',
      explanation: 'A voluntary assumption of care that excludes others creates a legal duty, making omission actionable.',
    },
    {
      id: 'q2',
      prompt: 'Which of the following best explains why ‚Äúcreation of the peril‚Äù is bracketed in the omissions list in your notes?',
      choices: [
        { id: 'a', label: 'It is never recognized as a valid source of a duty in American jurisdictions.' },
        { id: 'b', label: 'It is recognized only in common law jurisdictions, not in MPC jurisdictions.' },
        {
          id: 'c',
          label: 'Some jurisdictions accept it as creating a duty to act, while others do not, so it is less universally accepted than the other four duty categories.',
        },
        { id: 'd', label: 'It is redundant of the ‚Äústatus relationship‚Äù category and therefore generally ignored.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Creation of peril is inconsistently recognized, so it is bracketed as a less-settled duty source.',
    },
    {
      id: 'q3',
      prompt: 'Under the MPC definition of involuntary acts, which of the following is most clearly an involuntary act?',
      choices: [
        { id: 'a', label: 'A person who chooses to drive after drinking and falls asleep at the wheel.' },
        { id: 'b', label: 'A person whose arm reflexively jerks while being unexpectedly shocked, striking another.' },
        { id: 'c', label: 'A person who drinks voluntarily and then assaults another while drunk.' },
        { id: 'd', label: 'A person who drives while texting and hits a pedestrian.' },
      ],
      correctChoiceId: 'b',
      explanation: 'A reflexive movement after an unexpected shock fits the MPC list of involuntary acts.',
    },
    {
      id: 'q4',
      prompt: 'In Martin v. State, why was the conviction reversed under the voluntariness requirement?',
      choices: [
        { id: 'a', label: 'Because the defendant was unconscious when arrested.' },
        { id: 'b', label: 'Because the statute required proof of specific intent to be drunk.' },
        {
          id: 'c',
          label: 'Because the defendant was involuntarily brought onto the public highway by the police, so the ‚Äúbeing on the highway‚Äù element was not voluntary.',
        },
        { id: 'd', label: 'Because the statute was deemed void for vagueness.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Police compelled presence on the highway, so the act element was not voluntary.',
    },
    {
      id: 'q5',
      prompt: 'Which scenario most clearly violates the legality principle as described in your notes?',
      choices: [
        {
          id: 'a',
          label: 'Prosecuting someone for a common law crime that is ‚Äúinherently offensive to public morals‚Äù even though no statute defines it.',
        },
        {
          id: 'b',
          label: 'Prosecuting someone for violating a statute that is ambiguous, but related case law clarifies its meaning.',
        },
        { id: 'c', label: 'Prosecuting someone for conduct clearly described in a criminal statute that was enacted after the conduct occurred.' },
        { id: 'd', label: 'Both A and C.' },
      ],
      correctChoiceId: 'd',
      explanation: 'Both common law crime without statute and retroactive application offend legality and fair notice.',
    },
    {
      id: 'q6',
      prompt: 'Which is the primary justification for the modern legality principle NOT emphasized in the traditional ‚Äúcommon law crime‚Äù approach?',
      choices: [
        { id: 'a', label: 'Individual autonomy' },
        { id: 'b', label: 'Fair notice and separation of powers' },
        { id: 'c', label: 'Efficient law enforcement' },
        { id: 'd', label: 'Proportionality of punishment' },
      ],
      correctChoiceId: 'b',
      explanation: 'Modern legality highlights fair notice and legislative primacy over judicial crime creation.',
    },
    {
      id: 'q7',
      prompt:
        'A vagrancy statute punishes ‚Äúall persons of ill repute who cannot give a good account of themselves.‚Äù A challenge arguing that this statute is ‚Äúvoid for vagueness‚Äù is most likely to succeed based on which concern?',
      choices: [
        { id: 'a', label: 'It criminalizes mere thoughts rather than acts.' },
        { id: 'b', label: 'It fails to give fair notice and invites arbitrary enforcement because of its lack of specificity.' },
        { id: 'c', label: 'It punishes omissions only.' },
        { id: 'd', label: 'It mandates strict liability for a serious felony.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The vague terms give no clear standard and enable arbitrary enforcement, violating due process.',
    },
    {
      id: 'q8',
      prompt:
        'Under the MPC ‚Äúdistributive default rule,‚Äù if a statute reads, ‚ÄúA person is guilty if he knowingly sells, delivers, or transports a controlled substance,‚Äù which is presumed?',
      choices: [
        { id: 'a', label: '‚ÄúKnowingly‚Äù applies only to ‚Äúsells.‚Äù' },
        { id: 'b', label: '‚ÄúKnowingly‚Äù applies to ‚Äúsells‚Äù and ‚Äúdelivers,‚Äù but not ‚Äútransports.‚Äù' },
        { id: 'c', label: '‚ÄúKnowingly‚Äù applies to all three verbs unless a contrary purpose plainly appears.' },
        { id: 'd', label: '‚ÄúKnowingly‚Äù is read out because the statute is too ambiguous.' },
      ],
      correctChoiceId: 'c',
      explanation: 'The MPC distributes the stated mens rea to each material element absent contrary intent.',
    },
    {
      id: 'q9',
      prompt:
        'Under the MPC ‚Äúrecklessness default rule,‚Äù when a statute defining an offense does not specify mens rea for a material element, the prosecution can satisfy the mental element by proving that the defendant acted:',
      choices: [
        { id: 'a', label: 'Purposely only.' },
        { id: 'b', label: 'Purposely or knowingly only.' },
        { id: 'c', label: 'Recklessly or negligently.' },
        { id: 'd', label: 'Purposely, knowingly, or recklessly.' },
      ],
      correctChoiceId: 'd',
      explanation: 'Recklessness is the default minimum, so purpose or knowledge also suffice.',
    },
    {
      id: 'q10',
      prompt: 'Which of the following best captures the difference between ‚Äúpure‚Äù and ‚Äúimpure‚Äù strict liability as used in your notes?',
      choices: [
        { id: 'a', label: 'Pure involves statutory rape; impure involves public welfare offenses.' },
        {
          id: 'b',
          label: 'Pure has no mens rea for any material element; impure has at least one material element with a mens rea requirement and at least one treated as strict liability.',
        },
        { id: 'c', label: 'Pure applies only to felonies; impure only to misdemeanors.' },
        { id: 'd', label: 'Pure is allowed under the MPC for any crime; impure is prohibited.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Pure strict liability removes mens rea from all elements, while impure mixes strict and mental elements.',
    },
    {
      id: 'q11',
      prompt: 'Which of the following is most consistent with the modern federal approach to ‚Äúpublic welfare offenses‚Äù in your materials?',
      choices: [
        { id: 'a', label: 'Mens rea is always strictly read out because public safety is paramount.' },
        { id: 'b', label: 'Courts generally read in at least purpose or knowledge to separate wrongful from innocent conduct.' },
        { id: 'c', label: 'Courts presume negligence is enough for all public welfare offenses.' },
        { id: 'd', label: 'Public welfare offenses are presumed unconstitutional under the Due Process Clause.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Modern federal cases often imply knowledge or purpose to avoid criminalizing innocent conduct.',
    },
    {
      id: 'q12',
      prompt:
        'Under the common law homicide scheme in your notes, which scenario most clearly supports first-degree murder based on premeditation and deliberation?',
      choices: [
        { id: 'a', label: 'A man impulsively shoots someone who insults him in a bar.' },
        {
          id: 'b',
          label: 'A man buys a gun a week earlier, lies in wait outside the victim‚Äôs house, and calmly shoots the victim when he appears.',
        },
        { id: 'c', label: 'A driver speeds through a red light and kills a pedestrian.' },
        { id: 'd', label: 'A man fires randomly into the air on New Year‚Äôs Eve, killing someone blocks away.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Planning, lying in wait, and calm execution show premeditation and deliberation for first-degree murder.',
    },
    {
      id: 'q13',
      prompt: 'The ‚Äúdepraved heart‚Äù murder description in your outline requires which combination of features?',
      choices: [
        { id: 'a', label: 'Recklessness only.' },
        { id: 'b', label: 'Extreme recklessness plus a base antisocial motive and a high probability of death.' },
        { id: 'c', label: 'Negligence plus foreseeability.' },
        { id: 'd', label: 'Malice plus premeditation and deliberation.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Depraved heart requires extreme recklessness with malignant indifference to a high risk of death.',
    },
    {
      id: 'q14',
      prompt:
        'Under traditional voluntary manslaughter (‚Äúheat of passion‚Äù/provocation), which of the following is least likely to qualify as adequate provocation under the categorical approach?',
      choices: [
        { id: 'a', label: 'Catching one‚Äôs spouse in the act of adultery.' },
        { id: 'b', label: 'A violent physical assault on the defendant.' },
        { id: 'c', label: 'Being informed hours earlier by a friend that the victim insulted the defendant‚Äôs business reputation.' },
        { id: 'd', label: 'Seeing someone break into the defendant‚Äôs home at night.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Mere words about insults, especially after time passes, typically are inadequate provocation.',
    },
    {
      id: 'q15',
      prompt: 'Under the modern provocation approach in your notes, which statement is most accurate?',
      choices: [
        { id: 'a', label: 'Only specific, historically recognized categories of provocation may be considered.' },
        {
          id: 'b',
          label: 'The question is whether a reasonable person in the defendant‚Äôs circumstances would have been provoked and would not have cooled off.',
        },
        { id: 'c', label: 'Cooling time is fixed by statute.' },
        { id: 'd', label: 'Cumulative provocation is irrelevant.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Modern tests use a reasonable person standard with the defendant‚Äôs circumstances and consider cooling time contextually.',
    },
    {
      id: 'q16',
      prompt: 'Under your outline‚Äôs description, ‚Äúinvoluntary manslaughter‚Äù in traditional jurisdictions is most often based on:',
      choices: [
        { id: 'a', label: 'Purpose or knowledge.' },
        { id: 'b', label: 'Recklessness only.' },
        { id: 'c', label: 'Criminal (gross) negligence, though some states use ordinary negligence.' },
        { id: 'd', label: 'Strict liability.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Traditional involuntary manslaughter typically rests on criminal negligence and, in some places, ordinary negligence.',
    },
    {
      id: 'q17',
      prompt: 'According to the MPC scheme in your notes, which is true about homicide?',
      choices: [
        { id: 'a', label: 'MPC retains the term ‚Äúinvoluntary manslaughter.‚Äù' },
        { id: 'b', label: 'MPC treats felony murder as a subset of depraved heart murder.' },
        { id: 'c', label: 'MPC has no negligent homicide offense.' },
        { id: 'd', label: 'MPC equates heat-of-passion manslaughter with second-degree murder.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The MPC lists felony murder as a presumption of extreme indifference murder, akin to depraved heart.',
    },
    {
      id: 'q18',
      prompt: 'Under the MPC, ‚ÄúExtreme Emotional Disturbance‚Äù (EED) differs from common law provocation primarily because:',
      choices: [
        { id: 'a', label: 'It requires an objective reasonable person test only.' },
        {
          id: 'b',
          label: 'It allows consideration of the actor‚Äôs situation (including some personal handicaps) and cumulative provocation, and does not require traditional ‚Äúcategories.‚Äù',
        },
        { id: 'c', label: 'It requires a ‚Äúnatural force‚Äù trigger.' },
        { id: 'd', label: 'It requires that the defendant actually kill more than one person.' },
      ],
      correctChoiceId: 'b',
      explanation: 'EED is broader, considering the actor‚Äôs situation and cumulative stressors without rigid categories.',
    },
    {
      id: 'q19',
      prompt: 'Which of the following is most accurate regarding vehicular manslaughter in your materials?',
      choices: [
        { id: 'a', label: 'At common law it was always a strict liability offense.' },
        {
          id: 'b',
          label: 'Under modern statutory approaches described, it typically uses an ordinary negligence standard ‚Äì a material deviation from the reasonable person‚Äôs standard.',
        },
        { id: 'c', label: 'The MPC treats all vehicular killings as murder.' },
        { id: 'd', label: 'The MPC rejects negligent homicide for vehicular killings.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Modern vehicular manslaughter statutes usually hinge on ordinary negligence or a material deviation from reasonable driving.',
    },
    {
      id: 'q20',
      prompt: 'Under the property crimes section, which statement about claim of right is correct?',
      choices: [
        { id: 'a', label: 'It is never a defense to larceny or robbery.' },
        { id: 'b', label: 'It is a defense to both larceny and robbery whenever the claim is reasonable.' },
        {
          id: 'c',
          label: 'It is a defense to larceny even if the belief is mistaken, so long as it is genuine, but not a defense to robbery when cash/fungible items are taken to satisfy a debt.',
        },
        { id: 'd', label: 'It is recognized only in MPC jurisdictions.' },
      ],
      correctChoiceId: 'c',
      explanation: 'A sincere claim negates larceny intent, but taking cash by force for a debt is still robbery.',
    },
    {
      id: 'q21',
      prompt: 'The key distinction between false pretenses and larceny by trick in your outline is:',
      choices: [
        { id: 'a', label: 'Whether the defendant uses a written versus oral misrepresentation.' },
        { id: 'b', label: 'Whether the victim passes title (false pretenses) or only possession/custody (larceny by trick).' },
        { id: 'c', label: 'Whether the property is real property or personal property.' },
        { id: 'd', label: 'Whether the victim is a merchant.' },
      ],
      correctChoiceId: 'b',
      explanation: 'False pretenses involves obtaining title through deceit, while larceny by trick obtains mere possession.',
    },
    {
      id: 'q22',
      prompt: 'Under your notes, which of the following most clearly constitutes embezzlement rather than larceny?',
      choices: [
        { id: 'a', label: 'A shoplifter conceals jeans in a backpack and walks out of a store.' },
        { id: 'b', label: 'A visitor steals jewelry from a host‚Äôs bedroom.' },
        {
          id: 'c',
          label: 'A bank teller, who lawfully possesses the cash drawer as part of her job, secretly transfers funds into her own account.',
        },
        { id: 'd', label: 'A person obtains money from a stranger by lying about a fake charity and walks away with the cash.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Embezzlement covers conversion by one already in lawful possession, like a teller diverting funds.',
    },
    {
      id: 'q23',
      prompt: 'Under the modern definition of burglary in your outline, which element is no longer required compared to the common law definition?',
      choices: [
        { id: 'a', label: 'Entering.' },
        { id: 'b', label: 'As a trespasser.' },
        { id: 'c', label: 'Intent to commit a felony therein.' },
        { id: 'd', label: 'Breaking and nighttime.' },
      ],
      correctChoiceId: 'd',
      explanation: 'Modern burglary statutes typically drop the ‚Äúbreaking‚Äù and ‚Äúnighttime‚Äù requirements.',
    },
    {
      id: 'q24',
      prompt: 'A man picks a woman‚Äôs pocket on a crowded subway without her noticing. According to your materials, this is:',
      choices: [
        { id: 'a', label: 'Robbery, because the victim‚Äôs person was touched.' },
        { id: 'b', label: 'Robbery, because it occurred in public.' },
        { id: 'c', label: 'Larceny, because there was no force or fear used; the victim was unaware.' },
        { id: 'd', label: 'Burglary, because it occurred in an enclosed space.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Without force or intimidation, surreptitious taking from the person is larceny, not robbery.',
    },
    {
      id: 'q25',
      prompt: 'Under the attempt section, which statement best describes the MPC‚Äôs approach to grading attempt?',
      choices: [
        { id: 'a', label: 'Attempt is always punished as a misdemeanor regardless of the object crime.' },
        { id: 'b', label: 'Attempt is graded one degree lower than the object crime.' },
        {
          id: 'c',
          label: 'Attempt is generally punished the same as the object crime, except attempt to commit first-degree murder is punished as second-degree murder.',
        },
        { id: 'd', label: 'Attempt is always punished more severely than the completed crime to deter attempts.' },
      ],
      correctChoiceId: 'c',
      explanation: 'The MPC aligns attempt with the target offense, with a carveout lowering first-degree murder attempts.',
    },
    {
      id: 'q26',
      prompt: 'Under the majority common law approach to attempt mens rea in your notes, which is required?',
      choices: [
        { id: 'a', label: 'Only that the defendant negligently risked causing the result.' },
        { id: 'b', label: 'That the defendant specifically intended the conduct but not necessarily the result.' },
        {
          id: 'c',
          label: 'That the defendant has specific intent as to conduct and result elements; circumstance elements usually take the underlying offense‚Äôs mens rea.',
        },
        { id: 'd', label: 'That the defendant act with malice toward the victim.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Attempt generally demands intent to bring about the result and to engage in the conduct, with circumstances following the target crime standard.',
    },
    {
      id: 'q27',
      prompt: 'Under the MPC‚Äôs approach to attempt mens rea in your outline:',
      choices: [
        { id: 'a', label: 'Attempt requires recklessness as to conduct and result.' },
        { id: 'b', label: 'Attempt requires purpose as to conduct and purpose or belief (knowledge) as to result elements.' },
        { id: 'c', label: 'Attempt requires negligence for all elements.' },
        { id: 'd', label: 'Attempt cannot apply to crimes with result elements.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The MPC demands purposeful action and purpose or belief regarding the result for attempt liability.',
    },
    {
      id: 'q28',
      prompt: 'Which of the following tests for the actus reus of attempt is explicitly associated with the MPC and adopted by the majority of jurisdictions?',
      choices: [
        { id: 'a', label: 'Proximity test.' },
        { id: 'b', label: 'Unequivocality (‚Äúres ipsa‚Äù) test.' },
        { id: 'c', label: 'Probable desistence test.' },
        { id: 'd', label: 'Substantial step test.' },
      ],
      correctChoiceId: 'd',
      explanation: 'The MPC endorses the substantial step test, widely adopted for attempt actus reus.',
    },
    {
      id: 'q29',
      prompt: 'Under the MPC, abandonment is a defense to attempt only if:',
      choices: [
        { id: 'a', label: 'The defendant stops because he sees police approaching.' },
        { id: 'b', label: 'The defendant stops because he decides the crime will not succeed.' },
        { id: 'c', label: 'The defendant‚Äôs renunciation is complete and voluntary, and he abandons or prevents the crime.' },
        { id: 'd', label: 'The defendant is persuaded by a co-conspirator to stop.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Renunciation must be voluntary and complete, accompanied by abandonment or prevention.',
    },
    {
      id: 'q30',
      prompt: 'Under the ‚Äúkill zone‚Äù theory described in your notes, attempted murder liability may extend to:',
      choices: [
        { id: 'a', label: 'Only the specifically named target of the attack.' },
        {
          id: 'b',
          label: 'Everyone in the zone of danger when the defendant uses a method intended to ensure the death of the target even if that necessarily endangers others.',
        },
        { id: 'c', label: 'Only victims who actually die.' },
        { id: 'd', label: 'Only victims who suffer serious bodily injury.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Intent to kill the target by creating a lethal zone can transfer to others within that zone for attempt.',
    },
    {
      id: 'q31',
      prompt: 'Under your complicity section, which of the following reflects the MPC standard for accomplice liability?',
      choices: [
        { id: 'a', label: 'The accomplice must be present at the scene to be liable.' },
        { id: 'b', label: 'The accomplice must act ‚Äúwith the purpose of promoting or facilitating‚Äù the offense and aid, agree to aid, or attempt to aid.' },
        { id: 'c', label: 'Mere knowledge of the crime is always sufficient.' },
        { id: 'd', label: 'Only pre-crime assistance counts, not assistance during the crime.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The MPC requires purposeful promotion or facilitation plus assistance or an offer/attempt to assist.',
    },
    {
      id: 'q32',
      prompt: 'Under the MPC‚Äôs treatment of complicity and attempt:',
      choices: [
        { id: 'a', label: 'There is no liability if the principal never attempts or commits the crime.' },
        { id: 'b', label: 'One may be guilty of attempted complicity even if the principal does not commit or attempt the crime.' },
        { id: 'c', label: 'Accomplice liability is limited to misdemeanors.' },
        { id: 'd', label: 'Accessory-after-the-fact conduct is never punished.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The MPC recognizes attempted complicity when someone purposely aids with requisite intent even if the crime is not tried.',
    },
    {
      id: 'q33',
      prompt: 'Under common law rules on withdrawal from complicity, which of the following is required for an aider (who actually helped) to withdraw?',
      choices: [
        { id: 'a', label: 'Merely changing his mind before the crime is committed.' },
        { id: 'b', label: 'Neutralizing his assistance or otherwise preventing the crime, such as by promptly notifying authorities.' },
        { id: 'c', label: 'Publicly announcing disapproval after the crime.' },
        { id: 'd', label: 'Filing an affidavit in court renouncing the crime.' },
      ],
      correctChoiceId: 'b',
      explanation: 'An aider must undo or counteract assistance, often by warning police or victims, to withdraw.',
    },
    {
      id: 'q34',
      prompt: 'Under the MPC withdrawal standard for accomplices in your notes, a defendant must terminate complicity before the offense and:',
      choices: [
        { id: 'a', label: 'Merely intend to discourage the other person.' },
        { id: 'b', label: 'Wholly deprive his aid of effectiveness or give timely warning to law enforcement or otherwise make proper effort to prevent the offense.' },
        { id: 'c', label: 'Convince all co-felons to abandon the scheme.' },
        { id: 'd', label: 'Submit a written statement to law enforcement.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Effective withdrawal under the MPC requires nullifying aid or proactively trying to prevent the crime.',
    },
    {
      id: 'q35',
      prompt: 'Which of the following best states the Pinkerton doctrine as described in your outline?',
      choices: [
        { id: 'a', label: 'Conspirators are liable only for the conspiracy itself.' },
        {
          id: 'b',
          label: 'Conspirators are liable for every act committed by any co-conspirator, regardless of foreseeability.',
        },
        {
          id: 'c',
          label: 'Conspirators are liable for substantive crimes committed by co-conspirators that are in furtherance of the conspiracy and reasonably foreseeable.',
        },
        { id: 'd', label: 'Conspirators are never liable for substantive crimes unless they personally participated.' },
      ],
      correctChoiceId: 'c',
      explanation: 'Pinkerton imposes liability for foreseeable crimes in furtherance of the conspiracy even without direct participation.',
    },
    {
      id: 'q36',
      prompt: 'Under the MPC‚Äôs approach to conspiracy in your notes:',
      choices: [
        { id: 'a', label: 'An overt act is always required for every conspiracy.' },
        { id: 'b', label: 'No overt act is required for conspiracies to commit first- and second-degree felonies.' },
        { id: 'c', label: 'The MPC adopts a bilateral agreement requirement.' },
        { id: 'd', label: 'Pinkerton liability is expanded.' },
      ],
      correctChoiceId: 'b',
      explanation: 'For the most serious felonies the MPC does not require proof of an overt act.',
    },
    {
      id: 'q37',
      prompt: 'Under the ‚Äúunilateral‚Äù approach to conspiracy in the MPC:',
      choices: [
        { id: 'a', label: 'There must be at least two genuine conspirators.' },
        { id: 'b', label: 'A defendant can be guilty even if the co-conspirator feigned agreement (e.g., an undercover officer).' },
        { id: 'c', label: 'Conspiracy charges require all co-conspirators to be tried together.' },
        { id: 'd', label: 'The doctrine applies only to drug offenses.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The MPC allows conviction based on the defendant‚Äôs own agreement and purpose, even if the other party lacks genuine intent.',
    },
    {
      id: 'q38',
      prompt: 'According to the MPC‚Äôs merger rule described in your outline:',
      choices: [
        { id: 'a', label: 'Conspiracy always merges into the completed offense.' },
        { id: 'b', label: 'Conspiracy merges into attempt but not into the completed offense.' },
        { id: 'c', label: 'Conspiracy does not merge into the completed offense.' },
        { id: 'd', label: 'Conspiracy merges into completed offenses only if the statute so states.' },
      ],
      correctChoiceId: 'c',
      explanation: 'MPC treats conspiracy separately, so it does not merge with attempt or the completed crime.',
    },
    {
      id: 'q39',
      prompt: 'Under your materials, a ‚ÄúWharton‚Äôs Rule‚Äù exception to conspiracy applies when:',
      choices: [
        { id: 'a', label: 'The underlying offense by definition requires two participants, and there is no added societal danger from the agreement itself.' },
        { id: 'b', label: 'The agreement is made in writing.' },
        { id: 'c', label: 'The conspirators are relatives.' },
        { id: 'd', label: 'The crime is a misdemeanor.' },
      ],
      correctChoiceId: 'a',
      explanation: 'When the substantive offense inherently needs two people (e.g., dueling), an extra conspiracy charge adds no separate danger.',
    },
    {
      id: 'q40',
      prompt: 'Under the traditional felony murder rule summarized in your notes:',
      choices: [
        { id: 'a', label: 'Any death during any felony automatically triggers murder liability.' },
        { id: 'b', label: 'The felony must be ‚Äúinherently dangerous,‚Äù and the killing must be in furtherance of and during the felony or immediate flight.' },
        { id: 'c', label: 'Only intended killings qualify.' },
        { id: 'd', label: 'Felony murder applies only to property crimes.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Felony murder attaches to inherently dangerous felonies when the death occurs in furtherance of the felony or immediate escape.',
    },
    {
      id: 'q41',
      prompt: 'Under the ‚Äúagency‚Äù limitation on felony murder mentioned in your outline:',
      choices: [
        { id: 'a', label: 'Any killing by anyone during a felony counts.' },
        { id: 'b', label: 'A felon is liable only for killings committed by co-felons, not by victims or police.' },
        { id: 'c', label: 'Felony murder applies only if the victim was a bystander.' },
        { id: 'd', label: 'The felon is liable for any death caused by resisting arrest.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Agency requires the killing be done by an agent of the felons; killings by opponents break felony murder liability.',
    },
    {
      id: 'q42',
      prompt: 'Under the ‚Äúproximate cause‚Äù approach to felony murder as described in your notes:',
      choices: [
        { id: 'a', label: 'Only co-felons‚Äô killings count.' },
        { id: 'b', label: 'Any death proximately caused by the felon‚Äôs conduct can trigger felony murder, even if a victim or police fired the fatal shot.' },
        { id: 'c', label: 'Felony murder is impossible if the felon is absent when the death occurs.' },
        { id: 'd', label: 'Felony murder applies only to intentional killings.' },
      ],
      correctChoiceId: 'b',
      explanation: 'Proximate cause jurisdictions impose liability for foreseeable deaths proximately caused by the felony, regardless of who pulled the trigger.',
    },
    {
      id: 'q43',
      prompt: 'Under the MPC‚Äôs approach to felony murder noted in your materials:',
      choices: [
        { id: 'a', label: 'Felony murder is abolished.' },
        { id: 'b', label: 'A presumption of extreme indifference murder arises when certain enumerated felonies are committed.' },
        { id: 'c', label: 'Felony murder is strict liability for any death during any felony.' },
        { id: 'd', label: 'Felony murder applies even when the felony is a misdemeanor.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The MPC lists specific felonies that create a rebuttable presumption of extreme indifference murder.',
    },
    {
      id: 'q44',
      prompt: 'Under the insanity defenses in your notes, the M‚ÄôNaghten test focuses on:',
      choices: [
        { id: 'a', label: 'Irresistible impulse.' },
        { id: 'b', label: 'Inability to understand the nature and quality of the act or to know that the act was wrong.' },
        { id: 'c', label: 'Inability to resist impulses or to follow commands.' },
        { id: 'd', label: 'Inability to distinguish legal wrong from moral wrong.' },
      ],
      correctChoiceId: 'b',
      explanation: 'M‚ÄôNaghten asks whether the defendant understood the act‚Äôs nature or knew it was wrong.',
    },
    {
      id: 'q50',
      prompt: 'Under the ALI/MPC insanity test described in your materials:',
      choices: [
        { id: 'a', label: 'Only cognitive incapacity‚Äîfailure to know right from wrong‚Äîmatters.' },
        {
          id: 'b',
          label:
            'The defendant is insane if, as a result of mental disease or defect, he lacks substantial capacity either to appreciate the wrongfulness of his conduct or to conform his conduct to the law.',
        },
        { id: 'c', label: 'The test is stricter than M‚ÄôNaghten and rarely satisfied.' },
        { id: 'd', label: 'The defense is unavailable in all homicide cases.' },
      ],
      correctChoiceId: 'b',
      explanation: 'The ALI/MPC test uses a substantial-capacity standard for both cognitive and volitional impairment.',
    },
  ];

  return Promise.resolve(sampleQuestions);
}

const state = {
  questions: [],
  currentIndex: 0,
  score: 0,
  answered: {}, // questionId -> choiceId
};

const questionContainer = document.getElementById('question-container');
const feedbackEl = document.getElementById('feedback');
const progressCountEl = document.getElementById('progress-count');
const scoreEl = document.getElementById('score');
const submitBtn = document.getElementById('submit-btn');
const nextBtn = document.getElementById('next-btn');
const resetBtn = document.getElementById('reset-btn');
const reviewToggle = document.getElementById('review-toggle');
const reviewList = document.getElementById('review-list');

function loadProgress() {
  const savedIndex = Number(localStorage.getItem(storageKeys.index));
  const savedScore = Number(localStorage.getItem(storageKeys.score));
  const savedAnswered = localStorage.getItem(storageKeys.answered);

  if (!Number.isNaN(savedIndex)) {
    state.currentIndex = savedIndex;
  }
  if (!Number.isNaN(savedScore)) {
    state.score = savedScore;
  }
  if (savedAnswered) {
    try {
      state.answered = JSON.parse(savedAnswered);
    } catch (error) {
      state.answered = {};
    }
  }
}

function saveProgress() {
  localStorage.setItem(storageKeys.index, String(state.currentIndex));
  localStorage.setItem(storageKeys.score, String(state.score));
  localStorage.setItem(storageKeys.answered, JSON.stringify(state.answered));
}

function setButtonStates({ submitted }) {
  submitBtn.disabled = submitted;
  nextBtn.disabled = state.currentIndex >= state.questions.length - 1 || !submitted;
}

function clearStoredProgress() {
  Object.values(storageKeys).forEach((key) => localStorage.removeItem(key));
}

function renderQuestion() {
  const question = state.questions[state.currentIndex];
  questionContainer.innerHTML = '';
  if (!question) {
    questionContainer.innerHTML = '<p>Loading questions‚Ä¶</p>';
    return;
  }

  const formFragment = document.createDocumentFragment();
  const questionWrapper = document.createElement('div');
  questionWrapper.className = 'question';
  questionWrapper.setAttribute('aria-live', 'polite');

  const prompt = document.createElement('h2');
  prompt.textContent = question.prompt;
  questionWrapper.appendChild(prompt);

  const choicesList = document.createElement('div');
  choicesList.className = 'choices';
  choicesList.setAttribute('role', 'radiogroup');
  choicesList.setAttribute('aria-label', 'Possible answers');

  question.choices.forEach((choice) => {
    const choiceLabel = document.createElement('label');
    choiceLabel.className = 'choice';
    choiceLabel.htmlFor = `${question.id}-${choice.id}`;

    const input = document.createElement('input');
    input.type = 'radio';
    input.name = `choice-${question.id}`;
    input.id = `${question.id}-${choice.id}`;
    input.value = choice.id;
    input.required = true;
    input.setAttribute('aria-label', choice.label);

    const savedChoice = state.answered[question.id];
    if (savedChoice === choice.id) {
      input.checked = true;
    }

    const labelText = document.createElement('span');
    labelText.textContent = choice.label;

    choiceLabel.appendChild(input);
    choiceLabel.appendChild(labelText);
    choicesList.appendChild(choiceLabel);
  });

  questionWrapper.appendChild(choicesList);
  formFragment.appendChild(questionWrapper);
  questionContainer.appendChild(formFragment);

  const submitted = Boolean(state.answered[question.id]);
  setButtonStates({ submitted });
  updateProgress();
  renderFeedback();
}

function renderFeedback() {
  const question = state.questions[state.currentIndex];
  const answer = state.answered[question?.id];
  if (!question || !answer) {
    feedbackEl.innerHTML = '';
    return;
  }

  const isCorrect = answer === question.correctChoiceId;
  feedbackEl.innerHTML = '';

  const result = document.createElement('p');
  result.className = isCorrect ? 'correct' : 'incorrect';
  result.textContent = isCorrect ? 'Correct!' : 'Incorrect.';

  const explanation = document.createElement('p');
  explanation.textContent = question.explanation;

  feedbackEl.appendChild(result);
  feedbackEl.appendChild(explanation);
}

function updateProgress() {
  progressCountEl.textContent = `Question ${state.currentIndex + 1} of ${state.questions.length}`;
  scoreEl.textContent = `Score: ${state.score}`;
}

function handleSubmit(event) {
  event.preventDefault();
  const question = state.questions[state.currentIndex];
  if (!question) return;
  if (state.answered[question.id]) {
    return;
  }

  const selected = questionContainer.querySelector('input[type="radio"]:checked');
  if (!selected) {
    feedbackEl.innerHTML = '<p class="incorrect">Select an answer to continue.</p>';
    return;
  }

  const choiceId = selected.value;
  state.answered[question.id] = choiceId;
  if (choiceId === question.correctChoiceId) {
    state.score += 1;
  }

  saveProgress();
  renderFeedback();
  setButtonStates({ submitted: true });
  renderReviewCards();
}

function handleNext() {
  if (state.currentIndex < state.questions.length - 1) {
    state.currentIndex += 1;
    saveProgress();
    renderQuestion();
  }
}

function handleReset() {
  if (!state.questions.length) return;
  state.currentIndex = 0;
  state.score = 0;
  state.answered = {};

  clearStoredProgress();
  renderQuestion();
  renderReviewCards();
}

function renderReviewCards() {
  reviewList.innerHTML = '';
  state.questions.forEach((question, index) => {
    const choiceId = state.answered[question.id];
    if (!choiceId) return;

    const card = document.createElement('article');
    card.className = 'review-card';

    const title = document.createElement('h3');
    title.textContent = `Q${index + 1}: ${question.prompt}`;

    const status = document.createElement('p');
    const isCorrect = choiceId === question.correctChoiceId;
    status.className = `status ${isCorrect ? 'correct' : 'incorrect'}`;
    status.textContent = isCorrect ? 'Correct' : 'Incorrect';

    const meta = document.createElement('p');
    meta.className = 'meta';
    meta.textContent = `Your answer: ${labelForChoice(question, choiceId)}`;

    const explanation = document.createElement('p');
    explanation.textContent = question.explanation;

    const choicesList = document.createElement('ul');
    question.choices.forEach((choice) => {
      const li = document.createElement('li');
      const isSelected = choice.id === choiceId;
      const isAnswer = choice.id === question.correctChoiceId;
      li.textContent = `${choice.label}${isAnswer ? ' (correct answer)' : ''}${isSelected && !isAnswer ? ' (your choice)' : ''}`;
      choicesList.appendChild(li);
    });

    card.appendChild(title);
    card.appendChild(status);
    card.appendChild(meta);
    card.appendChild(explanation);
    card.appendChild(choicesList);
    reviewList.appendChild(card);
  });
}

function labelForChoice(question, choiceId) {
  const match = question.choices.find((choice) => choice.id === choiceId);
  return match ? match.label : 'Not answered';
}

function toggleReviewMode() {
  reviewList.classList.toggle('is-visible');
  if (reviewList.classList.contains('is-visible')) {
    renderReviewCards();
    reviewToggle.textContent = 'Hide Review Mode';
  } else {
    reviewToggle.textContent = 'Show Review Mode';
  }
}

function init() {
  loadProgress();
  loadQuestions().then((questions) => {
    state.questions = questions;
    if (state.currentIndex >= questions.length) {
      state.currentIndex = 0;
    }
    renderQuestion();
    renderReviewCards();
  });
}

const quizForm = document.getElementById('quiz-form');
quizForm.addEventListener('submit', handleSubmit);
nextBtn.addEventListener('click', handleNext);
resetBtn.addEventListener('click', handleReset);
reviewToggle.addEventListener('click', toggleReviewMode);

document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
